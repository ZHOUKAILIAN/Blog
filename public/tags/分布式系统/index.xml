<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>分布式系统 on ZHOUKAILIAN Personal Blog</title>
    <link>http://localhost:1313/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/</link>
    <description>Recent content in 分布式系统 on ZHOUKAILIAN Personal Blog</description>
    <generator>Hugo</generator>
    <language>en</language>
    <lastBuildDate>Sun, 07 Dec 2025 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>消息队列（MQ）完全指南</title>
      <link>http://localhost:1313/posts/message-queue/</link>
      <pubDate>Sun, 07 Dec 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/message-queue/</guid>
      <description>&lt;h1 id=&#34;消息队列mq完全指南&#34;&gt;消息队列（MQ）完全指南&lt;/h1&gt;&#xA;&lt;h2 id=&#34;1-什么是消息队列&#34;&gt;1. 什么是消息队列&lt;/h2&gt;&#xA;&lt;p&gt;消息队列（MessageQueue，MQ）是分布式系统中的重要组件。主要是用于解决&lt;strong&gt;异步、解耦、削峰&lt;/strong&gt;等问题，通过高效可靠的消息传递机制进行平台无关的数据交流，可以在分布式环境下扩展进程间的通信，基于数据通信来进行分布式系统的集成，以实现高性能、高可用、可伸缩和最终一致性架构。&lt;/p&gt;&#xA;&lt;p&gt;使用队列最常见的场景就是&lt;strong&gt;生产者/消费者模式&lt;/strong&gt;：生产者生产消息放到队列中，消费者从队列里面获取消息消费。典型架构如下图所示：&lt;/p&gt;&#xA;&lt;p&gt;&lt;img&#xA;        class=&#34;lazyload&#34;&#xA;        src=&#34;http://localhost:1313/svg/loading.min.svg&#34;&#xA;        data-src=&#34;http://localhost:1313/posts/message-queue/images/mq-architecture.jpg&#34;&#xA;        data-srcset=&#34;http://localhost:1313/posts/message-queue/images/mq-architecture.jpg, http://localhost:1313/posts/message-queue/images/mq-architecture.jpg 1.5x, http://localhost:1313/posts/message-queue/images/mq-architecture.jpg 2x&#34;&#xA;        data-sizes=&#34;auto&#34;&#xA;        alt=&#34;/posts/message-queue/images/mq-architecture.jpg&#34;&#xA;        title=&#34;消息队列架构&#34; width=&#34;1630&#34; height=&#34;458&#34; /&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;2-消息队列的作用&#34;&gt;2. 消息队列的作用&lt;/h2&gt;&#xA;&lt;h3 id=&#34;21-异步&#34;&gt;2.1 异步&lt;/h3&gt;&#xA;&lt;p&gt;&lt;strong&gt;举例&lt;/strong&gt;：快递员发快递，一定要找到客户面对面送货效率会很低。引用快递驿站后，快递员只需要把快递放到驿站，就可以继续发其他快递去了，客户自行安排时间去驿站取快递。&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;作用&lt;/strong&gt;：&lt;strong&gt;异步能提高系统的响应速度、吞吐量&lt;/strong&gt;。&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;也可以使用 Future 实现（Java 中）&lt;/p&gt;&lt;/blockquote&gt;&#xA;&lt;h3 id=&#34;22-解耦&#34;&gt;2.2 解耦&lt;/h3&gt;&#xA;&lt;p&gt;&lt;strong&gt;举例&lt;/strong&gt;：快递员发快递，一定要找到客户面对面送货就一定要等到双方都有空才能完成投递操作，既依赖于用户是否有时间，也依赖于快递员是否有时间。引用快递驿站后，快递员只需要把快递放到驿站，就可以继续发其他快递去了，客户自行安排时间去驿站取快递。&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;作用&lt;/strong&gt;：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;服务之间进行解耦，才可以&lt;strong&gt;减少服务之间的影响，提高系统整体的稳定性以及可扩展性&lt;/strong&gt;。&lt;/li&gt;&#xA;&lt;li&gt;另外，解耦后可以实现数据分发。生产者发送一个消息后，可以由一个或者多个消费者进行消费，并且消费者的增加或者减少对生产者没有影响。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 id=&#34;23-削峰&#34;&gt;2.3 削峰&lt;/h3&gt;&#xA;&lt;p&gt;&lt;strong&gt;举例&lt;/strong&gt;：虽然长江每年都会涨水，但是下游出水口的速度是基本稳定的，就是因为引入大坝后，可以把水储存起来，下游慢慢排水。&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;作用&lt;/strong&gt;：&lt;strong&gt;以稳定的系统资源应对突发的流量冲击&lt;/strong&gt;（以免系统崩溃，避免使用限流的方式先把数据圈住）&lt;/p&gt;&#xA;&lt;h2 id=&#34;3-消息队列通信协议&#34;&gt;3. 消息队列通信协议&lt;/h2&gt;&#xA;&lt;p&gt;由于消息队列执行的是跨应用的信息传递，所以制定底层通信标准非常必要。目前主流的消息队列通信协议标准包括：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;AMQP&lt;/strong&gt; (Advanced Message Queuing Protocol)：通用协议，IBM 公司研发&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;JMS&lt;/strong&gt; (Java Message Service)：专门为 Java 语言服务，SUN 公司研发，一组由 Java 接口组成的 Java 标准&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;4-消息队列的选型&#34;&gt;4. 消息队列的选型&lt;/h2&gt;&#xA;&lt;h3 id=&#34;41-主流消息队列产品对比&#34;&gt;4.1 主流消息队列产品对比&lt;/h3&gt;&#xA;&lt;table&gt;&#xA;  &lt;thead&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;th&gt;特性&lt;/th&gt;&#xA;          &lt;th&gt;RabbitMQ&lt;/th&gt;&#xA;          &lt;th&gt;ActiveMQ&lt;/th&gt;&#xA;          &lt;th&gt;RocketMQ&lt;/th&gt;&#xA;          &lt;th&gt;Kafka&lt;/th&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/thead&gt;&#xA;  &lt;tbody&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;研发团队&lt;/td&gt;&#xA;          &lt;td&gt;Rabbit(公司)&lt;/td&gt;&#xA;          &lt;td&gt;Apache(社区)&lt;/td&gt;&#xA;          &lt;td&gt;阿里(公司)&lt;/td&gt;&#xA;          &lt;td&gt;Apache(社区)&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;开发语言&lt;/td&gt;&#xA;          &lt;td&gt;Erlang&lt;/td&gt;&#xA;          &lt;td&gt;Java&lt;/td&gt;&#xA;          &lt;td&gt;Java&lt;/td&gt;&#xA;          &lt;td&gt;Scala &amp;amp; Java&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;核心机制&lt;/td&gt;&#xA;          &lt;td&gt;基于 AMQP 的消息队列模型，使用生产者-消费者模式&lt;/td&gt;&#xA;          &lt;td&gt;基于 JMS 的消息传递模型，支持点对点和发布-订阅&lt;/td&gt;&#xA;          &lt;td&gt;分布式消息队列，采用主题(Topic)和标签(Tag)方式&lt;/td&gt;&#xA;          &lt;td&gt;分布式流平台，通过发布-订阅模型处理&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;协议支持&lt;/td&gt;&#xA;          &lt;td&gt;XMPP STOMP SMTP&lt;/td&gt;&#xA;          &lt;td&gt;XMPP STOMP OpenWire REST&lt;/td&gt;&#xA;          &lt;td&gt;自定义协议&lt;/td&gt;&#xA;          &lt;td&gt;自定义协议 + HTTP&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;客户端支持语言&lt;/td&gt;&#xA;          &lt;td&gt;官方支持多种语言&lt;/td&gt;&#xA;          &lt;td&gt;Java C/C++ Python PHP 等&lt;/td&gt;&#xA;          &lt;td&gt;Java C++&lt;/td&gt;&#xA;          &lt;td&gt;官方支持 Java，社区支持多种&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;可用性&lt;/td&gt;&#xA;          &lt;td&gt;镜像队列&lt;/td&gt;&#xA;          &lt;td&gt;主从复制&lt;/td&gt;&#xA;          &lt;td&gt;主从复制&lt;/td&gt;&#xA;          &lt;td&gt;分区和副本&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;单机吞吐量&lt;/td&gt;&#xA;          &lt;td&gt;每秒十万左右级别&lt;/td&gt;&#xA;          &lt;td&gt;每秒数万级&lt;/td&gt;&#xA;          &lt;td&gt;每秒十万+级&lt;/td&gt;&#xA;          &lt;td&gt;每秒百万级&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;消息延迟&lt;/td&gt;&#xA;          &lt;td&gt;微秒级&lt;/td&gt;&#xA;          &lt;td&gt;毫秒级&lt;/td&gt;&#xA;          &lt;td&gt;毫秒级&lt;/td&gt;&#xA;          &lt;td&gt;毫秒以内&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;功能特性&lt;/td&gt;&#xA;          &lt;td&gt;并发能力强，性能极好，延时低&lt;/td&gt;&#xA;          &lt;td&gt;老牌产品，成熟度高&lt;/td&gt;&#xA;          &lt;td&gt;MQ 功能完备，扩展性佳&lt;/td&gt;&#xA;          &lt;td&gt;专为大数据领域服务&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/tbody&gt;&#xA;&lt;/table&gt;&#xA;&lt;h2 id=&#34;5-kafka-详解&#34;&gt;5. Kafka 详解&lt;/h2&gt;&#xA;&lt;h3 id=&#34;51-kafka-架构&#34;&gt;5.1 Kafka 架构&lt;/h3&gt;&#xA;&lt;p&gt;&lt;img&#xA;        class=&#34;lazyload&#34;&#xA;        src=&#34;http://localhost:1313/svg/loading.min.svg&#34;&#xA;        data-src=&#34;http://localhost:1313/posts/message-queue/images/kafka-architecture.jpg&#34;&#xA;        data-srcset=&#34;http://localhost:1313/posts/message-queue/images/kafka-architecture.jpg, http://localhost:1313/posts/message-queue/images/kafka-architecture.jpg 1.5x, http://localhost:1313/posts/message-queue/images/kafka-architecture.jpg 2x&#34;&#xA;        data-sizes=&#34;auto&#34;&#xA;        alt=&#34;/posts/message-queue/images/kafka-architecture.jpg&#34;&#xA;        title=&#34;Kafka架构&#34; width=&#34;2246&#34; height=&#34;820&#34; /&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
